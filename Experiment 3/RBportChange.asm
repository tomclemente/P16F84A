LIST P=P16F84A, F=INHX8M
INCLUDE<P16F84.INC>
__CONFIG 3FF5H

FLAG EQU 0CH
TEMP EQU 0DH
CHK EQU 0EH
IHAP EQU 0FH

ORG 0000H
GOTO INIT
GOTO MAIN
ORG 0004H
GOTO INT_ROUTINE

INIT	CLRF STATUS
		BSF STATUS, RP0
		MOVLW 0BH ;1SECOND
		MOVWF OPTION_REG
		MOVLW 0F0H
		MOVWF TRISB
		CLRF TRISA
		BCF STATUS, RP0
		BSF INTCON, GIE
		BSF INTCON, RBIE
		BCF FLAG, 0
	;	MOVWF FLAG
	;	MOVWF TEMP
	;	MOVWF PORTB
	;	MOVWF PORTA
	;	MOVWF CHK


MAIN	
		BTFSS FLAG, 0 
		GOTO MAIN
		
		BCF FLAG, 0
		MOVLW 0F0H
		ANDWF PORTB, F

		MOVLW 10H
		
		XORWF PORTB, F
		BTFSC STATUS, Z
	 	GOTO DISPLAY
		MOVLW 20H
		XORWF PORTB, F
		BTFSC STATUS, Z
	 	GOTO DISPLAY
		MOVLW 40H
		XORWF PORTB, F
		BTFSC STATUS, Z
	 	GOTO DISPLAY
		MOVLW 80H
		XORWF PORTB, F
		BTFSC STATUS, Z
	 	GOTO DISPLAY
		MOVLW 00H
		XORWF PORTB, F
		BTFSC STATUS, Z
		GOTO DISPLAYZ
		GOTO INVALID
	



DISPLAY	
		
		MOVWF CHK
	
		SWAPF CHK, W
		CALL VERIFY
		MOVWF PORTB
		MOVWF TEMP
		MOVLW 02H
		MOVWF PORTA
		BSF INTCON, GIE
	;	BSF INTCON, RBIE
	;	CLRF FLAG
		GOTO MAIN


DISPLAYZ
		MOVWF PORTB
		MOVWF TEMP
		MOVLW 02H
		MOVWF PORTA
		BSF INTCON, GIE
	;	BSF INTCON, RBIE
	;	CLRF FLAG
		GOTO MAIN



INVALID	;MOVFW TEMP
		;MOVWF PORTB

		MOVF TEMP, W
		MOVWF PORTB
		MOVLW 01H
		MOVWF PORTA
		BSF INTCON, GIE
	;	BSF INTCON, RBIE
	;	CLRF FLAG
		GOTO MAIN
		
VERIFY
		ADDWF PCL, F
		RETLW 00H
		RETLW 08H
		RETLW 0AH
		NOP
		RETLW 0CH
		NOP
		NOP
		NOP
		RETLW 0EH
			



INT_ROUTINE
	BCF INTCON, GIE
	BCF INTCON, RBIE
	BTFSS INTCON, RBIF
	RETFIE
	BCF INTCON, RBIF

	BSF FLAG, 0

	RETFIE


END
